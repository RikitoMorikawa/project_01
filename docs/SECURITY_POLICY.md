# セキュリティポリシー

## 概要

このドキュメントは、CSR Lambda API システムのセキュリティポリシーを定義し、
個人情報保護とシステムセキュリティの確保に関する方針と手順を示します。

**最終更新日**: 2024 年 1 月 1 日  
**バージョン**: 1.0  
**承認者**: システム管理者

---

## 1. セキュリティ方針

### 1.1 基本方針

CSR Lambda API システムは、以下の基本方針に基づいてセキュリティを確保します：

- **機密性（Confidentiality）**: 個人情報への不正アクセスを防止
- **完全性（Integrity）**: データの改ざん・破損を防止
- **可用性（Availability）**: システムの継続的な利用を確保

### 1.2 適用範囲

本ポリシーは以下に適用されます：

- CSR Lambda API システム全体
- 関連する AWS インフラストラクチャ
- システムにアクセスするすべてのユーザー
- システム開発・運用に関わるすべての担当者

### 1.3 法的要件

本システムは以下の法的要件に準拠します：

- GDPR（EU 一般データ保護規則）
- 個人情報保護法（日本）
- サイバーセキュリティ基本法
- その他関連する法令・規制

---

## 2. データ分類とセキュリティレベル

### 2.1 データ分類

| 分類     | 説明                     | 例                                     |
| -------- | ------------------------ | -------------------------------------- |
| **機密** | 個人を特定できる情報     | メールアドレス、氏名、プロファイル情報 |
| **内部** | システム運用に必要な情報 | ログデータ、設定情報                   |
| **公開** | 一般に公開される情報     | プライバシーポリシー、利用規約         |

### 2.2 セキュリティレベル

#### 機密データ

- **暗号化**: AES-256 による暗号化必須
- **アクセス制御**: 認証・認可による厳格な制御
- **監査**: すべてのアクセスを記録
- **保持期間**: 法的要件に基づく期間制限

#### 内部データ

- **暗号化**: 通信時の暗号化必須
- **アクセス制御**: 職務に応じたアクセス制御
- **監査**: 重要な操作を記録

#### 公開データ

- **完全性**: 改ざん防止対策
- **可用性**: 適切なバックアップ

---

## 3. アクセス制御

### 3.1 認証

#### 3.1.1 ユーザー認証

- **多要素認証**: AWS Cognito による認証
- **パスワードポリシー**:
  - 最小 8 文字以上
  - 英数字・記号の組み合わせ
  - 定期的な変更推奨

#### 3.1.2 システム認証

- **API 認証**: JWT トークンによる認証
- **サービス間認証**: IAM ロールによる認証
- **トークン管理**: 適切な有効期限設定

### 3.2 認可

#### 3.2.1 最小権限の原則

- ユーザーは必要最小限の権限のみ付与
- 定期的な権限見直し
- 職務分離の実施

#### 3.2.2 権限管理

- **管理者権限**: システム全体の管理
- **一般ユーザー権限**: 自身のデータのみアクセス可能
- **ゲスト権限**: 公開情報のみアクセス可能

### 3.3 セッション管理

- **セッション有効期限**: 24 時間
- **自動ログアウト**: 非アクティブ時の自動ログアウト
- **セッション固定攻撃対策**: セッション ID の再生成

---

## 4. データ暗号化

### 4.1 保存時暗号化

#### 4.1.1 データベース暗号化

- **Aurora MySQL**: AWS KMS による暗号化
- **個人データフィールド**: アプリケーションレベルでの暗号化
- **暗号化アルゴリズム**: AES-256-GCM

#### 4.1.2 ファイル暗号化

- **S3 バケット**: サーバーサイド暗号化（SSE-S3）
- **ログファイル**: CloudWatch Logs での暗号化

### 4.2 通信時暗号化

#### 4.2.1 HTTPS/TLS

- **最小バージョン**: TLS 1.2
- **推奨バージョン**: TLS 1.3
- **証明書**: AWS Certificate Manager

#### 4.2.2 API 通信

- **すべての API**: HTTPS 必須
- **内部通信**: VPC 内での暗号化通信

### 4.3 鍵管理

#### 4.3.1 暗号化キー

- **AWS KMS**: マスターキーの管理
- **キーローテーション**: 年次での自動ローテーション
- **アクセス制御**: IAM による厳格な制御

#### 4.3.2 アプリケーションキー

- **環境変数**: 暗号化された環境変数での管理
- **シークレット管理**: AWS Secrets Manager の利用

---

## 5. ネットワークセキュリティ

### 5.1 ネットワーク分離

#### 5.1.1 VPC 設計

- **プライベートサブネット**: データベース・Lambda 配置
- **パブリックサブネット**: NAT Gateway 配置
- **セキュリティグループ**: 最小限のポート開放

#### 5.1.2 アクセス制御

- **WAF**: Web Application Firewall による保護
- **API Gateway**: レート制限・IP 制限
- **CloudFront**: DDoS 攻撃対策

### 5.2 監視・検知

#### 5.2.1 ネットワーク監視

- **VPC Flow Logs**: ネットワークトラフィック監視
- **CloudTrail**: API 呼び出し監視
- **GuardDuty**: 脅威検知サービス

#### 5.2.2 異常検知

- **不正アクセス検知**: 異常なアクセスパターンの検知
- **DDoS 攻撃検知**: トラフィック異常の検知
- **マルウェア検知**: ファイルアップロード時のスキャン

---

## 6. 監査・ログ管理

### 6.1 監査ログ

#### 6.1.1 記録対象

- **データアクセス**: すべての個人データアクセス
- **システム操作**: 管理者操作・設定変更
- **認証イベント**: ログイン・ログアウト・認証失敗

#### 6.1.2 ログ項目

- **タイムスタンプ**: UTC 時刻
- **ユーザー ID**: 操作実行者
- **操作内容**: 実行されたアクション
- **対象データ**: アクセス・変更されたデータ
- **IP アドレス**: アクセス元 IP
- **ユーザーエージェント**: ブラウザ・アプリ情報

### 6.2 ログ保護

#### 6.2.1 改ざん防止

- **ログ暗号化**: CloudWatch Logs での暗号化
- **アクセス制御**: 読み取り専用アクセス
- **整合性チェック**: ログの整合性検証

#### 6.2.2 保持期間

- **監査ログ**: 7 年間保持
- **アクセスログ**: 1 年間保持
- **システムログ**: 3 ヶ月間保持

### 6.3 ログ分析

#### 6.3.1 リアルタイム監視

- **異常検知**: 自動的な異常パターン検知
- **アラート**: 重要イベントの即座通知
- **ダッシュボード**: リアルタイム状況表示

#### 6.3.2 定期分析

- **月次レポート**: セキュリティ状況の定期報告
- **トレンド分析**: 長期的な傾向分析
- **コンプライアンス確認**: 法的要件への準拠確認

---

## 7. インシデント対応

### 7.1 インシデント分類

#### 7.1.1 重要度レベル

| レベル   | 説明                       | 対応時間    |
| -------- | -------------------------- | ----------- |
| **緊急** | データ漏洩・システム侵害   | 1 時間以内  |
| **高**   | 不正アクセス・サービス停止 | 4 時間以内  |
| **中**   | セキュリティ警告・性能問題 | 24 時間以内 |
| **低**   | 軽微な問題・改善提案       | 1 週間以内  |

#### 7.1.2 インシデント種別

- **データ漏洩**: 個人情報の不正取得・公開
- **不正アクセス**: システムへの不正侵入
- **システム侵害**: マルウェア感染・改ざん
- **サービス停止**: 可用性の重大な影響

### 7.2 対応手順

#### 7.2.1 初期対応（0-1 時間）

1. **検知・報告**: インシデントの検知と初期報告
2. **影響評価**: 被害範囲の初期評価
3. **封じ込め**: 被害拡大の防止措置
4. **チーム招集**: 対応チームの緊急招集

#### 7.2.2 詳細対応（1-24 時間）

1. **詳細調査**: 根本原因と影響範囲の詳細調査
2. **証拠保全**: フォレンジック証拠の保全
3. **復旧作業**: システム・データの復旧
4. **暫定対策**: 再発防止の暫定措置

#### 7.2.3 事後対応（24 時間以降）

1. **根本対策**: 恒久的な再発防止策
2. **報告書作成**: 詳細な事故報告書
3. **関係者報告**: 監督機関・ユーザーへの報告
4. **改善実施**: プロセス・システムの改善

### 7.3 通知・報告

#### 7.3.1 内部報告

- **即座報告**: 検知から 1 時間以内
- **詳細報告**: 24 時間以内の詳細報告
- **最終報告**: 対応完了後の最終報告

#### 7.3.2 外部報告

- **監督機関**: データ漏洩時 72 時間以内（GDPR）
- **ユーザー**: 高リスク時の速やかな通知
- **関係機関**: 必要に応じた関係機関への報告

---

## 8. 脆弱性管理

### 8.1 脆弱性評価

#### 8.1.1 定期スキャン

- **頻度**: 月次での自動スキャン
- **対象**: すべてのシステムコンポーネント
- **ツール**: AWS Inspector・サードパーティツール

#### 8.1.2 評価基準

- **CVSS スコア**: 共通脆弱性評価システム
- **影響度**: システムへの潜在的影響
- **悪用可能性**: 攻撃の容易さ

### 8.2 パッチ管理

#### 8.2.1 優先度

- **緊急**: CVSS 9.0 以上 - 24 時間以内
- **高**: CVSS 7.0-8.9 - 1 週間以内
- **中**: CVSS 4.0-6.9 - 1 ヶ月以内
- **低**: CVSS 3.9 以下 - 次回メンテナンス時

#### 8.2.2 適用プロセス

1. **脆弱性確認**: 影響範囲と対策の確認
2. **テスト環境**: 開発環境での動作確認
3. **本番適用**: 計画的な本番環境への適用
4. **動作確認**: 適用後の動作確認

---

## 9. セキュリティ教育・訓練

### 9.1 定期教育

#### 9.1.1 全体研修

- **頻度**: 年 2 回
- **内容**: セキュリティ基礎・最新脅威
- **対象**: すべての関係者

#### 9.1.2 専門研修

- **頻度**: 四半期ごと
- **内容**: 技術的セキュリティ・インシデント対応
- **対象**: 技術担当者

### 9.2 訓練・演習

#### 9.2.1 インシデント対応訓練

- **頻度**: 年 1 回
- **内容**: 模擬インシデントでの対応訓練
- **評価**: 対応時間・手順の適切性

#### 9.2.2 災害復旧訓練

- **頻度**: 年 1 回
- **内容**: システム復旧手順の確認
- **評価**: 復旧時間・データ整合性

---

## 10. 第三者セキュリティ

### 10.1 クラウドプロバイダー

#### 10.1.1 AWS セキュリティ

- **責任共有モデル**: AWS・顧客の責任分界
- **セキュリティ認証**: SOC・ISO・FedRAMP 準拠
- **定期監査**: AWS セキュリティ状況の確認

#### 10.1.2 設定管理

- **セキュリティ設定**: AWS Config による設定監視
- **ベストプラクティス**: AWS Well-Architected 準拠
- **定期見直し**: 設定の定期的な見直し

### 10.2 外部サービス

#### 10.2.1 評価基準

- **セキュリティ認証**: 適切な認証取得
- **データ保護**: 個人情報保護の適切性
- **契約条項**: セキュリティ要件の明記

#### 10.2.2 継続監視

- **定期評価**: 年次でのセキュリティ評価
- **インシデント共有**: セキュリティ情報の共有
- **契約見直し**: セキュリティ要件の更新

---

## 11. 継続的改善

### 11.1 セキュリティ評価

#### 11.1.1 定期評価

- **頻度**: 四半期ごと
- **内容**: セキュリティ対策の有効性評価
- **指標**: KPI・KRI による定量評価

#### 11.1.2 外部監査

- **頻度**: 年 1 回
- **内容**: 第三者によるセキュリティ監査
- **範囲**: システム全体・プロセス・文書

### 11.2 改善活動

#### 11.2.1 改善計画

- **年次計画**: セキュリティ改善の年次計画
- **優先順位**: リスクベースでの優先順位付け
- **進捗管理**: 定期的な進捗確認

#### 11.2.2 技術更新

- **新技術導入**: セキュリティ技術の継続的導入
- **標準更新**: セキュリティ標準の定期更新
- **ベンチマーク**: 業界標準との比較

---

## 12. 連絡先・責任者

### 12.1 セキュリティ責任者

- **CISO**: システム管理者
- **メール**: security@example.com
- **緊急連絡**: [緊急連絡先]

### 12.2 インシデント対応チーム

- **チームリーダー**: [責任者名]
- **技術担当**: [技術者名]
- **法務担当**: [法務担当者名]
- **広報担当**: [広報担当者名]

### 12.3 外部連絡先

- **セキュリティベンダー**: [ベンダー連絡先]
- **法律事務所**: [法律事務所連絡先]
- **監督機関**: [監督機関連絡先]

---

## 13. 関連文書

- [GDPR コンプライアンス チェックリスト](./GDPR_COMPLIANCE_CHECKLIST.md)
- [インシデント対応手順](./INCIDENT_RESPONSE.md)
- [プライバシーポリシー](../frontend/src/pages/privacy.tsx)
- [利用規約](../frontend/src/pages/terms.tsx)

---

## 14. 改訂履歴

| バージョン | 日付       | 変更内容 | 承認者         |
| ---------- | ---------- | -------- | -------------- |
| 1.0        | 2024-01-01 | 初版作成 | システム管理者 |

---

**注意**: このセキュリティポリシーは機密文書です。適切な管理と定期的な見直しを行ってください。
